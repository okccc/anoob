- 事务
```sql
-- 事务就是对表的更新操作(insert/delete/update),使数据从一种状态变换到另一种状态,有acid四大特性
atomicity   -- 原子性：一组事务中的所有操作要么全部成功(commit),要么全部失败(rollback),并且一旦提交就无法回滚
consistency -- 一致性：几个并行执行的事务其执行结果和执行顺序无关
isolation   -- 隔离性：事务的执行不受其他事务的干扰
durability  -- 持久性：已提交的事务对数据库的改变是永久生效的
-- 什么时候会提交数据
a.执行DML操作,默认情况下一旦执行完就会自动提交数据 -> set autocommit = false
b.一旦断开数据库连接,也会提交数据 -> 将获取conn步骤从update方法中剥离出来单独关闭
    
-- 事务隔离：解决脏读、不可重复读、幻读
脏读：读到了别的事务还未提交的数据,这些数据可能会回滚也就是最终不一定存在的数据
可重复读：在一个事务内,最开始读到的数据和事务结束前任意时刻读到的同一批数据是一致的,针对update操作
不可重复读：在一个事务内,不同时刻读到的同一批数据可能不一致,可能会受到别的事务影响,针对update操作
幻读：事务A更新了数据但还未提交,此时事务B插入了与事务A修改之前相同的行数据且提交了,然后在事务A中查询发现刚才的修改好像没起作用,其实是事务B刚插入的,针对insert操作
-- 事务隔离级别：由于事务隔离是通过加锁实现的,所以隔离强度递增性能递减
读未提交：不加锁,性能最好,但是相当于裸奔,连脏读都无法解决(不考虑)
读提交：事务A只能读到事务B已提交的的数据,解决脏读,但是做不到可重复读,也无法解决幻读
可重复读：事务A读不到事务B已提交的数据,事务A开始时数据啥样在事务A提交前都不会变(mysql默认)
串行化：加共享锁,将事务变成顺序执行,相当于单线程,性能最差(不考虑)
-- 查看事务隔离级别
mysql> show variables like 'tx_isolation' | select @@tx_isolation
+-----------------------+-----------------+
| Variable_name         | Value           |
+-----------------------+-----------------+
| transaction_isolation | REPEATABLE-READ |
+-----------------------+-----------------+
-- 修改事务隔离级别,重启生效
mysql> set global transaction isolation level read committed;
-- 查看当前正在运行的事务
mysql> select * from information_schema.innodb_trx;
           脏读    不可重复读    幻读
读未提交    可能    可能         可能
读提交      不可能  可能         可能
可重复读    不可能  不可能        可能
串行化      不可能  不可能       不可能
```